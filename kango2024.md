---
marp: true
theme: default
paginate: true
header: '手術室看護協会 講演会'
footer: 'Page'
math: mathjax
---

# 1.1. 正規分布とは

## 正規分布の概念

- データが平均値を中心に左右対称に分布する
- 多くの自然現象や測定値に見られる


---

## 2SDが95%の範囲

- 標準偏差 (SD) はデータの散らばり具合を示す
- 平均値 ±2SD の範囲に全体の約95%のデータが含まれる


- 標準正規分布
![正規分布のグラフ](https://upload.wikimedia.org/wikipedia/commons/8/8c/Standard_deviation_diagram.svg)


---

# 1.2. 平均値と中央値の比較

## 平均値と中央値

- **平均値 (Mean)**: データの総和をデータの個数で割った値
  - 外れ値に敏感
- **中央値 (Median)**: データを小さい順に並べたときの中央の値
  - 外れ値に影響されにくい

---

## 標準偏差と四分位範囲

- **標準偏差 (Standard Deviation, SD)**: データの散らばり具合を示す
  - 平均値からのズレの平方和の平均値を平方根したもの
- **四分位範囲 (Interquartile Range, IQR)**: データの中央50%の範囲
  - 外れ値の影響を受けにくい

---

## 平均値と中央値の比較例

- **例1**: 正規分布では平均値と中央値はほぼ同じ
- **例2**: 歪んだ分布では中央値が平均値と異なる場合がある
  - 例えば、所得分布など


---

# アンケートスコアの評価

## 例: アンケート調査

- スコアの例
  - 5: よく理解した
  - 4: 理解した
  - 3: 少し理解した
  - 2: あまり理解できていない
  - 1: 理解できていない

---

## 連続変数とカテゴリ変数の違い

- **連続変数**: 測定値が連続的に変化する（例: 身長、体重）
- **カテゴリ変数**: 順序はあるが、連続的ではない（例: アンケートスコア）

### 平均値と中央値の評価に関する問題点

- カテゴリ変数は順序があるが、等間隔とは限らない
  - **平均値**はカテゴリ変数の間の距離を均等と仮定するため、誤った解釈を招く可能性がある
  - **中央値**は順位を考慮するが、情報の喪失がある

---

## カテゴリ変数の評価方法

### 1. **モード**の利用
- 最頻値（モード）はカテゴリ変数に適した統計量

### 2. **度数分布**の提示
- 各スコアの頻度や割合を視覚化
- **棒グラフ**や**ヒストグラム**を使用

### 3. **順序ロジスティック回帰**の活用
- 順序があるカテゴリ変数に適した解析方法
- より高度な解析が可能

---

## なぜ平均値を使わないのか？

- 平均値はカテゴリ間の距離が均等であることを前提とする
- アンケートのスコアは、感情や意識などを数値化したもので、間隔の均等性を保証できない
- 誤った解釈や意思決定のリスクを避けるため

### 適切な評価の重要性
- 看護師のアンケート結果は、患者ケアの質を評価するために重要
- 適切な統計手法を選択し、データの特性に応じた解釈が必要

---

# スコアの変化とカイ二乗検定

## 勉強前と勉強後のスコアの変化を解析

- **目的**: 勉強前後で理解度に変化があるかを解析
- **スコア**: 
  - 5: よく理解した
  - 4: 理解した
  - 3: 少し理解した
  - 2: あまり理解できていない
  - 1: 理解できていない


---

# 勉強前後のデータが独立している場合

## クロス集計表の作成

| スコア | 勉強前の人数 | 勉強後の人数 |
|--------|--------------|--------------|
| 5      | 15           | 25           |
| 4      | 20           | 30           |
| 3      | 30           | 20           |
| 2      | 20           | 15           |
| 1      | 15           | 10           |

- スコアを行、勉強前後を列に分けたクロス集計表を作成

---

## カイ二乗検定による解析

### カイ二乗検定の適用

- **独立データ**として解析
- 勉強前と勉強後のスコア分布に有意な差があるかを評価
- 観測値と期待値の差を基に、カイ二乗値を計算

### 手順

1. 各セルの期待値を計算
2. 観測値と期待値の差を基にカイ二乗値を計算
3. カイ二乗分布表を用いて有意性を判断

---


## スコアのクロス集計表

|          | 勉強後: よく理解した | 勉強後: 理解した | 勉強後: 少し理解した | 勉強後: あまり理解できていない | 勉強後: 理解できていない |
|----------|--------------------|----------------|--------------------|--------------------------|----------------------|
| **勉強前: よく理解した** | 20                 | 10             | 5                  | 2                        | 1                    |
| **勉強前: 理解した**      | 15                 | 25             | 10                 | 3                        | 2                    |
| **勉強前: 少し理解した**   | 5                  | 15             | 20                 | 10                       | 5                    |
| **勉強前: あまり理解できていない** | 2                  | 5              | 10                 | 15                       | 8                    |
| **勉強前: 理解できていない** | 1                  | 2              | 5                  | 8                        | 10                   |

---

## 対応データに対するマクネマー検定

### マクネマー検定の適用

- **前提**: 同一対象者の勉強前後のスコア（対応データ）
- **マクネマー検定**: 同じ対象者の2つの関連カテゴリデータの変化を評価
- **適用例**: 同一対象者に対する勉強前後の効果を評価

---

## 独立データと対応データの違い

### 独立データ

- 異なるグループから得られたデータ
- カイ二乗検定を適用

### 対応データ

- 同じ対象者の異なる時点のデータ
- マクネマー検定を適用

---

# 1.3 正規分布の確認方法

## 正規分布の重要性

- **正規分布**: データが平均値を中心に左右対称に分布
- 統計解析でパラメトリック手法を使うためには、データが正規分布に従っているかを確認することが重要

---

## 正規分布の確認手法

### 1. Shapiro-Wilk 検定

- **対象**: 小さなサンプルサイズ（n<50）
- **特徴**: 正規性の検定として広く使用される
- **結果**: p値が小さい（通常p<0.05）場合、正規分布ではない

---

### 2. Kolmogorov-Smirnov (KS) 検定

- **対象**: 大きなサンプルサイズにも対応
- **特徴**: データ分布と理論的な正規分布の差を評価
- **結果**: p値が小さい場合、データは正規分布に従っていない

---

### 3. Anderson-Darling 検定

- **対象**: サンプルの尾部（極端な値）に敏感
- **特徴**: 正規分布の尾部に重点を置いた検定
- **結果**: p値が小さい場合、データは正規分布に従っていない

---

### 4. Cramér-von Mises 検定

- **対象**: データ全体の適合性を均等に評価
- **特徴**: 正規分布に対する一般的な適合度検定
- **結果**: p値が小さい場合、データは正規分布に従っていない

---

### 5. Jarque-Bera 検定

- **対象**: 歪度と尖度を基にした検定
- **特徴**: 正規分布からの逸脱が歪度と尖度によるかを評価
- **結果**: p値が小さい場合、データは正規分布に従っていない

---

### 6. D’Agostino-Pearson 検定

- **対象**: 歪度と尖度を組み合わせた検定
- **特徴**: 正規分布からの逸脱を総合的に評価
- **結果**: p値が小さい場合、データは正規分布に従っていない

---

## 検定結果の解釈

- **p値 < 0.05**: 正規分布に従わない可能性が高い
- **p値 > 0.05**: 正規分布に従っていると考えられる
- **注意点**: サンプルサイズや検定方法により、結果が異なる場合がある

---

## 検定結果に基づく対応

- **パラメトリック手法**: 正規分布に従っている場合に使用
- **ノンパラメトリック手法**: 正規分布に従っていない場合に適用
- **外れ値の影響**: 検出された外れ値を除去して再度検定を行うことが推奨される場合もある
---

# 外れ値とその影響

## 外れ値の重要性

- **外れ値**: データの中で他の観測値から極端に外れた値
- 外れ値が統計解析に与える影響は大きく、特に平均値や分散の計算に影響を与える

---

## 外れ値の影響

- **正規性の歪み**: 外れ値があると、データが正規分布から逸脱する可能性が高まる
- **統計検定への影響**: 外れ値が検定結果を大きく歪める可能性があるため、検出と対処が必要

---

## 外れ値の検出方法

### 1. 箱ひげ図（Boxplot）

- データの四分位範囲を示し、外れ値を視覚的に検出
- **外れ値の定義**: 四分位範囲 (IQR) の1.5倍を超える範囲にあるデータポイント

![Boxplot](https://example.com/boxplot.png)

---

### 2. 標準偏差を用いた方法

- データの平均からの**3標準偏差**以上離れているデータポイントを外れ値とする
- **適用例**: 正規分布を仮定したデータセット
---

### 3. Zスコア

- 各データポイントが平均からどれだけ離れているかを標準偏差単位で表す
- **外れ値の基準**: Zスコアが±3を超える場合

---

### 4. DixonのQ検定

- 小規模なデータセットに適用可能な検定
- **外れ値の基準**: Q値が特定の閾値を超える場合に外れ値と判定

---

## 外れ値の対処方法

### 1. 外れ値の除去

- **条件**: 外れ値が計測エラーや異常値であると判断された場合
- **注意点**: 外れ値を除去するときは、データの特徴や背景を十分に考慮

### 2. データ変換

- **方法**: 対数変換や平方根変換を行い、データの歪みを軽減
- **目的**: 正規性を回復させ、解析の正確性を向上

### 3. ノンパラメトリック手法の使用

- **適用例**: 正規分布の仮定が崩れる場合に有効
- **方法**: 外れ値の影響を受けにくい統計手法を選択


---

# データ変換の詳細

## データ変換とは？

- **目的**: データの歪みを軽減し、正規分布に近づけること
- **適用例**: 外れ値の影響を受けやすいデータや、正規分布の仮定が崩れているデータ

---

## 1. 対数変換 (Log Transformation)

- **特徴**: 対数変換は、値の範囲を縮小し、右に歪んだデータを調整するのに有効
- **適用例**: 給与、価格など、広範囲の値を持つデータ
- **効果**: 大きな値の影響を抑え、分布を対称に近づける

### 数式

\[
y' = \log(y)
\]

- **注意点**: ゼロや負の値を含むデータには適用できないため、適切な定数を加える場合がある

---

## 2. 平方根変換 (Square Root Transformation)

- **特徴**: 値の範囲を縮小し、特に右に歪んだデータを調整
- **適用例**: カウントデータや、正の値のみを含むデータ
- **効果**: 正規分布に近づけ、外れ値の影響を軽減

### 数式

\[
y' = \sqrt{y}
\]

- **注意点**: データが負の値を含む場合には使用できない

---

## 3. 逆数変換 (Reciprocal Transformation)

- **特徴**: 特に大きな外れ値を強く抑制する効果がある
- **適用例**: 極端に大きな値を持つデータ
- **効果**: 大きな値を小さくし、分布を対称に近づける

### 数式

\[
y' = \frac{1}{y}
\]

- **注意点**: ゼロや負の値を含むデータには適用できない

---

## 4. Box-Cox変換

- **特徴**: データの形状に応じて最適な変換を自動的に選択する柔軟な方法
- **適用例**: 一般的な数値データ全般
- **効果**: パラメータ \(\lambda\) の最適化により、データの正規性を最大限に向上

### 数式

\[ 
y' = 
\begin{cases} 
\frac{y^\lambda - 1}{\lambda}, & \text{if } \lambda \neq 0 \\
\log(y), & \text{if } \lambda = 0
\end{cases}
\]

- **注意点**: データにゼロや負の値が含まれる場合、適用が制限される

---

## データ変換後の検証

- **再検定**: データ変換後は、再度正規性の検定を行う
- **解析手法の選択**: 正規性が確認できればパラメトリック手法を、確認できなければノンパラメトリック手法を使用
- **実務上の判断**: 変換後のデータが実際の解釈に与える影響を考慮する


---

## データ変換後の検証

- **再検定**: データ変換後は、再度正規性の検定を行う
- **解析手法の選択**: 正規性が確認できればパラメトリック手法を、確認できなければノンパラメトリック手法を使用
- **実務上の判断**: 変換後のデータが実際の解釈に与える影響を考慮する


---

## 検定結果に基づく対応

- **パラメトリック手法**: 正規分布に従っている場合に使用
- **ノンパラメトリック手法**: 正規分布に従っていない場合に適用
- **外れ値の影響**: 検出された外れ値を除去して再度検定を行うことが推奨される場合もある
